patterns:
  # Dash based patterns ex: api-dev.scanme.sh
  - "{{word}}-{{sub}}.{{suffix}}" # dev-api
  - "{{sub}}-{{word}}.{{suffix}}" # api-dev
  # Dot based patterns ex: dev.api.scanme.sh
  - "{{word}}.{{sub}}.{{suffix}}"
  - "{{sub}}.{{word}}.{{suffix}}"
  # Iteration based
  - "{{sub}}{{number}}.{{suffix}}"
  # replace current subdomain name
  - "{{word}}.{{suffix}}"
  # No Seperator (ex: devtest.scanme.sh)
  - "{{sub}}{{word}}.{{suffix}}"
  # add region perfix
  - "{{region}}.{{sub}}.{{suffix}}"
  # clusterbomb words and numbers
  # - "{{word}}{{number}}.{{suffix}}"

## Note:
# `-enrich/-e` option adds new words to `word` and `number` payloads only

## ============================================================================
## BACKWARD COMPATIBLE - EXISTING FORMAT (do not modify)
## ============================================================================
payloads:
  word:
    - "api"
    - "k8s"
    - "v1"
    - "v2"
    - "origin"
    - "raw"
    - "stage"
    - "test"
    - "qa"
    - "web"
    - "prod"
    - "service"
    - "grafana"
    - "beta"
    - "admin"
    - "staging"
    - "wordpress"
    - "wp"
    - "dev"
    - "app"
    - "mta-sts"
    - "tech"
    - "private"
    - "public"
    - "login"
    - "role"
    - "backend"
    - "cloud"
    - "internal"
    - "mail"
    - "oauth"
    - "oauth2"
    - "vpn"
    - "lab"
    - "local"
    - "live"
    - "data"
    - "mobile"
    - "search"
    - "stats"
    - "final"
    - "ldap"
    - "media"
    - "docs"
    - "eng"
    - "engineering"
    - "market"
    - "compute"
    - "cdn"
    - "acc"
    - "access"
    - "backup"
    - "blogs"
    - "blog"
    - "careers"
    - "client"
    - "cms"
    - "cms1"
    - "conf"
    - "dmz"
    - "drupal"
    - "corp"
    - "faq"
    - "ir"
    - "legacy"
    - "log"
    - "logs"
    - "dashboard"
    - "monitor"
    - "mysql"
    - "mssql"
    - "db"
    - "partner"
    - "payment"
    - "pay"
    - "office"
    - "plugins"
    - "shop"
    - "prometheus"
    - "stripe"
    - "forum"
    - "manager"
    - "server"
    - "core"
    - "content"
    - "ads"
    - "shopify"
    - "o1"
    - "s1"
    - "s3"
    - "promotion"
    - "temp"
    - "my"
    - "proxy"
    - "asset"
    - "assets"
    - "atlas"
    - "build"
    - "builds"
    - "code"
    - "info"
    - "image"
    - "review"
    - "developers"
    - "developer"
    - "administrator"
    - "www"
    - "www1"
    - "www2"
    - "netlify"
    - "storage"

  region:
    - "us-east-1"
    - "us-east-2"
    - "us-west-1"
    - "us-west-2"
    - "eu-east-1"
    - "eu-central-1"

  number:
    - "1"
    - "2"
    - "3"
    - "4"
    - "5"
    - "6"
    - "7"
    - "8"
    - "9"
    - "10"
    - "18"
    - "20"
    - "21"
    - "22"
    - "23"
    - "24"
    - "2017"
    - "2018"
    - "2019"
    - "2023"
    - "2024"
    - "2022"
    - "2021"
    - "2020"

## ============================================================================
## PATTERN INDUCTION EXTENSIONS (addon - backward compatible)
## ============================================================================
## This section is used by the pattern induction mode to store learned patterns
## and semantic token classifications.
##
## Generated by: alterx v0.0.0 (will be populated by CLI)
## Input domains: 0
## Patterns generated: 0
##
## DESIGN PRINCIPLES:
## 1. Existing format above is preserved - no breaking changes
## 2. Token dictionary provides semantic classification for common token types
## 3. Learned patterns are self-contained with inline payloads
## 4. Unknown payloads use positional naming (p0, p1, p2...)
## 5. Users can extend token_dictionary directly for domain-specific tokens
##
## CLASSIFICATION RULES:
## - Auto-classify if: ≥2 matches OR 1 highly-specific match (e.g., AWS regions)
## - Use positional naming (p0, p1...) for unknown/ambiguous payloads
## - Threshold: ≥70% overlap + specificity score ≥0.7
##
## CONFIDENCE FORMULA:
## - Base: 1.0 / ratio (ratio = possible_generations / observed_count)
## - Adjustment: +15% weight for coverage (logarithmic scale)
## - Formula: confidence = (0.85 × 1/ratio) + (0.15 × min(1.0, log10(coverage)/3.0))
## - Interpretation: % of generated subdomains that will be valid
##
## Example:
##   Coverage: 450 domains matched
##   Ratio: 1.2 (generates 540 subdomains / 450 observed)
##   Confidence: 0.84 (84% of generations will be valid)
## ============================================================================

## -----------------------------------------------------------------------------
## TOKEN DICTIONARY - Semantic Token Definitions
## -----------------------------------------------------------------------------
## Define known semantic token types that can be auto-classified during
## pattern learning. This dictionary is directly extensible - add your
## domain-specific token types here.
##
## Structure:
##   token_name:
##     description: "Human-readable description"
##     values: [list, of, values]
##
## Classification: When learning patterns, discovered payloads are matched
## against this dictionary. If ≥70% overlap + specificity ≥0.7, the payload
## is classified as this token type instead of using positional naming.
## -----------------------------------------------------------------------------
token_dictionary:
  # Environment identifiers (dev, prod, staging, etc.)
  env:
    description: "Environment/stage identifiers"
    values:
      - dev
      - prod
      - production
      - staging
      - stage
      - qa
      - test
      - demo
      - uat
      - preprod
      - sandbox

  # Cloud region identifiers (AWS, GCP, Azure formats)
  region:
    description: "Cloud provider region identifiers"
    values:
      - us-east-1
      - us-east-2
      - us-west-1
      - us-west-2
      - eu-east-1
      - eu-west-1
      - eu-west-2
      - eu-central-1
      - ap-south-1
      - ap-southeast-1
      - ap-southeast-2
      - ap-northeast-1
      - ca-central-1

  # Service/component names
  service:
    description: "Service or component identifiers"
    values:
      - api
      - web
      - cdn
      - db
      - database
      - cache
      - proxy
      - gateway
      - auth
      - admin
      - frontend
      - backend
      - worker
      - scheduler

  # API/service versions
  version:
    description: "API or service version identifiers"
    values:
      - v1
      - v2
      - v3
      - v4
      - alpha
      - beta
      - rc
      - canary
      - stable

  # Network visibility
  visibility:
    description: "Network visibility or access level"
    values:
      - internal
      - external
      - private
      - public
      - dmz

  # Database types
  database_type:
    description: "Database system types"
    values:
      - mysql
      - postgres
      - postgresql
      - mongodb
      - redis
      - elasticsearch
      - cassandra
      - dynamodb

## -----------------------------------------------------------------------------
## LEARNED PATTERNS - Pattern Induction Results
## -----------------------------------------------------------------------------
## This section contains patterns learned from observed subdomains using the
## pattern induction algorithm. Each pattern is self-contained with:
## - Unique ID for tracking
## - Template using token variables
## - Coverage: number of input domains matched
## - Ratio: possible_generations / observed_count
## - Confidence: quality score (0.0-1.0, higher is better)
## - Inline payloads for unknown/positional tokens
##
## TEMPLATE FORMAT:
##   Patterns use the same {{variable}} syntax as the manual patterns above.
##   Variables reference either:
##     - Token dictionary entries (e.g., {{env}}, {{region}})
##     - Inline positional payloads (e.g., {{p0}}, {{p1}})
##     - Built-in variables (e.g., {{sub}}, {{suffix}}, {{tld}})
##
## POSITIONAL PAYLOADS:
##   When discovered payloads don't match token_dictionary with sufficient
##   confidence, they are named positionally: p0, p1, p2, etc.
##   Users can promote these to token_dictionary if they recognize a pattern.
##
## USAGE:
##   - Pattern induction mode generates this section automatically
##   - Can be merged with manual patterns above
##   - Use --min-confidence flag to filter by quality threshold
## -----------------------------------------------------------------------------
learned_patterns:
  # Example learned pattern (this section is populated by pattern induction)
  #
  # - id: pattern_001
  #   template: "{{service}}-{{env}}-{{number}}.{{suffix}}"
  #   coverage: 450          # Matched 450 input domains
  #   ratio: 1.2             # Generates 1.2x observed (540 / 450)
  #   confidence: 0.84       # 84% of generations will be valid
  #   # No payloads section - uses token_dictionary
  #
  # - id: pattern_002
  #   template: "{{service}}-{{p0}}.{{suffix}}"
  #   coverage: 230
  #   ratio: 2.1
  #   confidence: 0.52
  #   payloads:
  #     # Unknown token - defined inline with positional name
  #     p0:
  #       values: [alpha, beta, gamma, delta]
  #       examples:
  #         - api-alpha.example.com
  #         - web-beta.example.com
  #
  # - id: pattern_003
  #   template: "{{p0}}-{{p1}}-{{p2}}.{{suffix}}"
  #   coverage: 85
  #   ratio: 3.2
  #   confidence: 0.38
  #   payloads:
  #     # All unknown - using positional names
  #     p0: [foo, bar, baz]
  #     p1: [red, blue, green]
  #     p2: [x, y, z]